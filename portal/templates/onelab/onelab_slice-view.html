{% extends "layout_wide.html" %}

{% block content %}
	<div class="col-md-2"></div>
	<div class="col-md-10">
		<div class="row">
		  	{% include theme|add:"_widget-slice-sections.html" %}
		</div>
    </div>
    
	<div class="col-md-2"></div>
	<div class="col-md-10">
        <br>
        <br>
        <div id="slice-tab-loading"><img src="{{ STATIC_URL }}img/loading.gif" alt="Loading Slices" /></div>
        <div id="slice-tab-loaded" style="display:none;">
            <table id="slice-tab">
            </table>
        </div>
  	</div>
 
<script>
    $(document).ready(function() {
        $.post("/rest/slice/",{'filters':{'slice_hrn':'{{slice}}'}}, function( data ) {
            var table_slices = [];
            /* "slice_hrn", "slice_description", "slice_type", "parent_authority", "created", "nodes", "slice_url", "slice_last_updated", "user", "slice_urn", "slice_expires" */
            $.each( data, function( key, val ) {
                if(val.nodes=="undefined" || val.nodes==null){
                    nodes_length=0;
                }else{
                    nodes_length=val.nodes.length;
                }

                if(val.user=="undefined" || val.user==null){
                    user_length=0;
                }else{
                    user_length=val.user.length;
                }

                if(val.slice_url=="undefined" || val.slice_url==null){
                    slice_url="";
                }else{
                    slice_url="<a href='"+val.slice_url+"' target='_blank'>"+val.slice_url+"</a>";
                }
                
                slice_row = "<tr><td><b>Description:</b></td><td>"+val.slice_description+"</td></tr>";
                slice_row += "<tr><td><b>url:</b></td><td><a href='"+val.slice_url+" target='_blank'>"+val.slice_url+"</a></td></tr>";
                slice_row += "<tr><td><b>users:</b></td><td>"+user_length+"</td></tr>";
                slice_row += "<tr><td><b>resources:</b></td><td>"+nodes_length+"</td></tr>";
                slice_row += "<tr><td><b>created:</b></td><td>"+val.created+"</td></tr>";
                slice_row += "<tr><td><b>last update:</b></td><td>"+val.last_updated+"</td></tr>";
                slice_row += "<tr><td><b>expires:</b></td><td>"+val.slice_expires+"</td></tr>";
                table_slices.push(slice_row);
            });
           $("table#slice-tab").html(table_slices.join( "" ));
           $("div#slice-tab-loaded").css("display","block");
           $("div#slice-tab-loading").css("display","none");
        });
    });
</script>
{% endblock %}
